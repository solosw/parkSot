{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/solosw/Desktop/ParkingLotManager/parkingSlot-wx/pages/parkinginfo/parkinginfo.vue?3b74","webpack:///C:/Users/solosw/Desktop/ParkingLotManager/parkingSlot-wx/pages/parkinginfo/parkinginfo.vue?a4de","webpack:///C:/Users/solosw/Desktop/ParkingLotManager/parkingSlot-wx/pages/parkinginfo/parkinginfo.vue?f282","webpack:///C:/Users/solosw/Desktop/ParkingLotManager/parkingSlot-wx/pages/parkinginfo/parkinginfo.vue?c927","uni-app:///pages/parkinginfo/parkinginfo.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","onLoad","uni","url","success","self","key","data","appointTime","user","chooseSlot","datetimesingle","baseInfo","amapPlugin","currentlatitude","currentlongitude","covers","latitude","longitude","parkSlots","parkCovers","parkDistance","methods","dialogInputConfirm","openId","slotId","content","method","title","icon","denunciate","sureAppiont","price","howLong","time","carSlotId","appiont","getDistance","Math","deg2rad","init","fail","console","iconPath","id","width","height","lng","onShow"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,oBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAwH;AACxH;AAC+D;AACL;;;AAG1D;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,sFAAM;AACR,EAAE,+FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,kRAEN;AACP,KAAK;AACL;AACA,aAAa,uPAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,aAAa,uPAEN;AACP,KAAK;AACL;AACA,aAAa,qRAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,gZAEN;AACP,KAAK;AACL;AACA,aAAa,oSAEN;AACP,KAAK;AACL;AACA,aAAa,gWAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnGA;AAAA;AAAA;AAAA;AAAqmB,CAAgB,+nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACkHznB;AAEA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;IAEA;IAEAC;MACAC;MACAC;QAEAC;QACAA;UACAC;QACA;QACAD;MACA;IACA;EAEA;EACAE;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAP;MACAQ;MACAC;MACAC;QACAC;QACAC;MAEA;QACAD;QACAC;MAEA;MACAC,aAEA;MAEAC,cAEA;MACAC;IAGA;EACA;EACAC;IACAC;MACA;MACArB;QACAC;QACAI;UAEAiB;UACAC;UACAC;QACA;QACAC;QACAvB;UACA;YAEAF;cACA0B;cACAC;YAEA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;UACAC;QACA;QACA;UACA9B;YACA0B;YACAC;UACA;UACA;QACA;QAEA3B;UACAC;UACAI;YACA0B;YACAC;YACAV;YACAC;YACAO;YACAG;UACA;UACAR;UACAvB;YAEAF;cACA0B;cACAC;YACA;YACAxB;YACAA;UACA;QACA;QACA;MACA;QACAH;UACA0B;UACAC;QAEA;MACA;MACA;IACA;IACAO;MAEA;MACA;QACAlC;UACA0B;UACAC;QACA;QACA;MACA;MACA;IACA;IACA;IACAQ;MACA;MACA;MACA;MAEA,QACAC,0CACAA,8DACAA;MACA;MACA;MACA;IACA;IAEAC;MACA;IACA;IACAC;MACA;MACA;QACApC;UAEAC;UACAA;QACA;QACAoC;UACAC;QACA;MACA;MACAxC;QACAC;QACAwB;QACAvB;UACAC;QACA;MACA;MACAH;QACAC;QACAwB;QACAvB;UACAC;UACA;YACA;cACAY;cACAC;cACAyB;cACAC;cACAC;cACAC;YACA;YACAzC;YACAA,iFACA0C;UAEA;QACA;MACA;MACA7C;QACAI;QACAF;UACAF;YACAC;YACAI;cACAqC;YACA;YACAjB;YACAvB;cAEAC;YAIA;YACAoC;cACAC;YACA;UACA;QACA;MACA;IAEA;EACA;EACAM,2BAGA;AACA;AAAA,2B","file":"pages/parkinginfo/parkinginfo.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/parkinginfo/parkinginfo.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./parkinginfo.vue?vue&type=template&id=535b3f54&\"\nvar renderjs\nimport script from \"./parkinginfo.vue?vue&type=script&lang=js&\"\nexport * from \"./parkinginfo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/parkinginfo/parkinginfo.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkinginfo.vue?vue&type=template&id=535b3f54&\"","var components\ntry {\n  components = {\n    uniNavBar: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar\" */ \"@/uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.vue\"\n      )\n    },\n    uniCard: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-card/components/uni-card/uni-card\" */ \"@/uni_modules/uni-card/components/uni-card/uni-card.vue\"\n      )\n    },\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n    uniGrid: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-grid/components/uni-grid/uni-grid\" */ \"@/uni_modules/uni-grid/components/uni-grid/uni-grid.vue\"\n      )\n    },\n    uniGridItem: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-grid/components/uni-grid-item/uni-grid-item\" */ \"@/uni_modules/uni-grid/components/uni-grid-item/uni-grid-item.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    uniDatetimePicker: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker\" */ \"@/uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker.vue\"\n      )\n    },\n    uniEasyinput: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput\" */ \"@/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.vue\"\n      )\n    },\n    uniPopupDialog: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog\" */ \"@/uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.parkSlots, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n    var m0 = _vm.getDistance(\n      item.lat,\n      item.lng,\n      _vm.currentlatitude,\n      _vm.currentlongitude\n    )\n    return {\n      $orig: $orig,\n      m0: m0,\n    }\n  })\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      return this.$refs.popup.close()\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkinginfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkinginfo.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view class=\"box-bg\">\r\n\t\t\t<uni-nav-bar shadow title=\"停车场\" />\r\n\t\t</view>\r\n\t\t<uni-card v-for=\"(item,index) in parkSlots\" padding=\"0\" spacing=\"0\" :key=\"index\">\r\n\r\n\t\t\t<template v-slot:cover>\r\n\r\n\t\t\t\t<view style=\"box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);\">\r\n\t\t\t\t\t<uni-icons type=\"location\" size=\"30\">\r\n\r\n\t\t\t\t\t</uni-icons>\r\n\t\t\t\t\t{{item.address}}\r\n\t\t\t\t</view>\r\n\r\n\r\n\t\t\t\t<view class=\"custom-cover\">\r\n\t\t\t\t\t<map style=\"width: 100%; height: 200rpx;\" :latitude=\"item.lat\" :longitude=\"item.lng\"\r\n\t\t\t\t\t\t:markers=\"parkCovers[index]\"></map>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t\t<uni-grid :column=\"3\" :highlight=\"true\">\r\n\t\t\t\t<uni-grid-item>\r\n\t\t\t\t\t<view class=\"grid-item-box\" :style=\"{\r\n\t\t\t\t            'color': item.useNumber === item.slotNumber ? 'red' : (item.useNumber > item.slotNumber / 2 ? 'yellow' : 'green'),\r\n\t\t\t\t            'display': 'flex',\r\n\t\t\t\t            'flex-direction': 'column',\r\n\t\t\t\t            'justify-content': 'center',\r\n\t\t\t\t            'align-content': 'center',\r\n\t\t\t\t            'align-items': 'center',\r\n\t\t\t\t            'justify-items': 'center'\r\n\t\t\t\t        }\">\r\n\t\t\t\t\t\t<view>{{ item.slotNumber }}</view>\r\n\t\t\t\t\t\t<text style=\"margin-top: 10%;\" class=\"text\">总车位</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-grid-item>\r\n\t\t\t\t<uni-grid-item>\r\n\t\t\t\t\t<view class=\"grid-item-box\" :style=\"{\r\n\t\t\t\t            'color': item.useNumber === item.slotNumber ? 'red' : (item.useNumber > item.slotNumber / 2 ? 'yellow' : 'green'),\r\n\t\t\t\t            'display': 'flex',\r\n\t\t\t\t            'flex-direction': 'column',\r\n\t\t\t\t            'justify-content': 'center',\r\n\t\t\t\t            'align-content': 'center',\r\n\t\t\t\t            'align-items': 'center',\r\n\t\t\t\t            'justify-items': 'center'\r\n\t\t\t\t        }\">\r\n\t\t\t\t\t\t<view>{{ item.useNumber }}</view>\r\n\t\t\t\t\t\t<text style=\"margin-top: 10%;\" class=\"text\">占用车位</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-grid-item>\r\n\t\t\t\t<uni-grid-item>\r\n\t\t\t\t\t<view class=\"grid-item-box\" :style=\"{\r\n\t\t\t\t            'color': item.useNumber === item.slotNumber ? 'red' : (item.useNumber > item.slotNumber / 2 ? 'yellow' : 'green'),\r\n\t\t\t\t            'display': 'flex',\r\n\t\t\t\t            'flex-direction': 'column',\r\n\t\t\t\t            'justify-content': 'center',\r\n\t\t\t\t            'align-content': 'center',\r\n\t\t\t\t            'align-items': 'center',\r\n\t\t\t\t            'justify-items': 'center'\r\n\t\t\t\t        }\">\r\n\t\t\t\t\t\t<view>{{ item.slotNumber - item.useNumber }}</view>\r\n\t\t\t\t\t\t<view class=\"text\" style=\"margin-top: 10%;\">剩余车位</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t</uni-grid-item>\r\n\t\t\t\t<uni-grid-item>\r\n\t\t\t\t\t<view class=\"grid-item-box\"\r\n\t\t\t\t\t\tstyle=\"background-color: #fff; display: flex;flex-direction: column;justify-content: center;align-content: center;align-items: center;justify-items: center;\">\r\n\t\t\t\t\t\t<view>{{item.price}}元/小时</view>\r\n\t\t\t\t\t\t<text style=\"margin-top: 10%;\" class=\"text\">价格</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-grid-item>\r\n\t\t\t\t<uni-grid-item>\r\n\t\t\t\t\t<view class=\"grid-item-box\"\r\n\t\t\t\t\t\tstyle=\"background-color: #fff; display: flex;flex-direction: column;justify-content: center;align-content: center;align-items: center;justify-items: center;\">\r\n\t\t\t\t\t\t<view>{{getDistance(item.lat, item\r\n\t\t\t\t\t\t\t\t.lng, currentlatitude, currentlongitude)}}米</view>\r\n\t\t\t\t\t\t<text style=\"margin-top: 10%;\" class=\"text\">距离</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-grid-item>\r\n\t\t\t</uni-grid>\r\n\t\t\t<view slot=\"actions\" class=\"card-actions no-border\">\r\n\t\t\t\t<view class=\"card-actions-item\" style=\"float: right;\">\r\n\t\t\t\r\n\t\t\t\t\t<button  size=\"mini\" class=\"card-actions-item-text\" @click=\"denunciate(item)\" type=\"default\" style=\"background-color: #00aaff;margin-right: 10rpx;\">举报</button>\r\n\t\t\t\t\t<button size=\"mini\" class=\"card-actions-item-text\" @click=\"appiont(item)\" type=\"default\" style=\"background-color: #00aaff;\">预约</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-card>\r\n\t\t<view>\r\n\t\t\t<view>\r\n\t\t\t\t<!-- 普通弹窗 -->\r\n\t\t\t\t<uni-popup type=\"bottom\" ref=\"popup\" background-color=\"#fff\" style=\"width: 400rpx;height: 300rpx;\">\r\n\t\t\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t\t\t<uni-datetime-picker type=\"datetime\" v-model=\"datetimesingle\" style=\"height: 300rpx;\"/>\r\n\t\t\t\t\t\t<uni-easyinput type=\"number\" placeholder=\"预约时长(小时)\" v-model=\"appointTime\"></uni-easyinput>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view style=\"display: flex; padding: 10rpx;\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<button type=\"default\" size=\"mini\" @click=\"this.$refs.popup.close()\"  style=\"background-color:#ff0000;\"> 取消</button>\r\n\t\t\t\t\t\t<button size=\"mini\" type=\"default\"  @click=\"sureAppiont\" style=\"background-color:#00aaff;\" >确认</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-popup>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<uni-popup ref=\"inputDialog\" type=\"dialog\">\r\n\t\t\t<uni-popup-dialog ref=\"inputClose\" mode=\"input\" title=\"举报\" placeholder=\"举报内容\"\r\n\t\t\t\t@confirm=\"dialogInputConfirm\"></uni-popup-dialog>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport amap, {\r\n\t\tAMapWX\r\n\t} from '../../common/amap-wx.130.js';\r\n\r\n\texport default {\r\n\t\tonLoad() {\r\n\t\t\t\r\n\t\t\tconst self=this;\r\n\t\t\r\n\t\t\tuni.request({\r\n\t\t\t\turl:self.systemRequest+\"/getSystem\",\r\n\t\t\t\tsuccess:function(res) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.key=res.data.wxKey\r\n\t\t\t\t\tself.amapPlugin = new amap.AMapWX({\r\n\t\t\t\t\t\tkey: self.key\r\n\t\t\t\t\t});\r\n\t\t\t\t\tself.init()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tappointTime: null,\r\n\t\t\t\tuser: null,\r\n\t\t\t\tchooseSlot: null,\r\n\t\t\t\tdatetimesingle: null,\r\n\t\t\t\tbaseInfo: null,\r\n\t\t\t\tamapPlugin: null,\r\n\t\t\t\tkey: '0f1b6537cf284b99f93fb6da7c6b323d',\r\n\t\t\t\tcurrentlatitude: 0,\r\n\t\t\t\tcurrentlongitude: 0,\r\n\t\t\t\tcovers: [{\r\n\t\t\t\t\tlatitude: 39.909,\r\n\t\t\t\t\tlongitude: 116.39742,\r\n\r\n\t\t\t\t}, {\r\n\t\t\t\t\tlatitude: 39.90,\r\n\t\t\t\t\tlongitude: 116.39,\r\n\r\n\t\t\t\t}],\r\n\t\t\t\tparkSlots: [\r\n\r\n\t\t\t\t],\r\n\r\n\t\t\t\tparkCovers: [\r\n\r\n\t\t\t\t],\r\n\t\t\t\tparkDistance: [\r\n\r\n\t\t\t\t],\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tdialogInputConfirm(value) {\r\n\t\t\t\tconst self = this;\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: this.request + \"/addDenunciation\",\r\n\t\t\t\t\tdata: {\r\n\r\n\t\t\t\t\t\topenId: self.user.id,\r\n\t\t\t\t\t\tslotId: self.chooseSlot.id,\r\n\t\t\t\t\t\tcontent: value\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tif (res.statusCode == 200) {\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"举报成功\",\r\n\t\t\t\t\t\t\t\ticon: \"success\",\r\n\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tdenunciate(item) {\r\n\t\t\t\tthis.chooseSlot = item\r\n\t\t\t\tthis.$refs.inputDialog.open();\r\n\t\t\t},\r\n\t\t\tsureAppiont() {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar selectedDateTime = new Date(self.datetimesingle).getTime(); // 获取选择的时间的时间戳\r\n\t\t\t\tvar currentDateTime = new Date().getTime(); // 获取当前时间的时间戳\r\n\t\t\t\tvar futureDateTime = currentDateTime + self.baseInfo.antecedentDay * 24 * 60 * 60 * 1000; // 计算7天后的时间戳\r\n\t\t\t\tif (self.user.status == 1) futureDateTime += 3 * 24 * 60 * 60 * 1000\r\n\t\t\t\tif (selectedDateTime > currentDateTime && selectedDateTime <= futureDateTime) {\r\n\t\t\t\t\tvar price = self.appointTime * self.chooseSlot.price;\r\n\t\t\t\t\tif (self.user.status == 1) {\r\n\t\t\t\t\t\tprice = price * self.baseInfo.vipDiscount\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.user.money < price) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"余额不足\",\r\n\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: self.request + \"/appointSlot\",\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\thowLong: self.appointTime,\r\n\t\t\t\t\t\t\ttime: self.datetimesingle,\r\n\t\t\t\t\t\t\topenId: self.user.id,\r\n\t\t\t\t\t\t\tslotId: self.chooseSlot.id,\r\n\t\t\t\t\t\t\tprice: price,\r\n\t\t\t\t\t\t\tcarSlotId: self.chooseSlot.useNumber + 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\tsuccess(res) {\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"预约成功\",\r\n\t\t\t\t\t\t\t\ticon: \"success\"\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tself.user = res.data\r\n\t\t\t\t\t\t\tself.chooseSlot.useNumber++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// 在这里执行您的逻辑\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"时间错误\",\r\n\t\t\t\t\t\ticon:\"error\"\r\n\t\t\t\t\t\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tthis.$refs.popup.close()\r\n\t\t\t},\r\n\t\t\tappiont(item) {\r\n\r\n\t\t\t\tthis.chooseSlot = item\r\n\t\t\t\tif (item.useNumber == item.slotNumber) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"停车位已满\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.$refs.popup.open()\r\n\t\t\t},\r\n\t\t\t// 计算两个经纬度点之间的距离\r\n\t\t\tgetDistance: function(lat1, lon1, lat2, lon2) {\r\n\t\t\t\tconst R = 6371; // 地球半径，单位为公里\r\n\t\t\t\tconst dLat = this.deg2rad(lat2 - lat1);\r\n\t\t\t\tconst dLon = this.deg2rad(lon2 - lon1);\r\n\r\n\t\t\t\tconst a =\r\n\t\t\t\t\tMath.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n\t\t\t\t\tMath.cos(this.deg2rad(lat1)) * Math.cos(this.deg2rad(lat2)) *\r\n\t\t\t\t\tMath.sin(dLon / 2) * Math.sin(dLon / 2);\r\n\t\t\t\tconst c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\t\t\t\tconst distance = R * c; // 距离，单位为公里\r\n\t\t\t\treturn Math.round(distance * 1000);\r\n\t\t\t},\r\n\r\n\t\t\tdeg2rad: function(deg) {\r\n\t\t\t\treturn deg * (Math.PI / 180);\r\n\t\t\t},\r\n\t\t\tinit() {\r\n\t\t\t\tconst self = this;\r\n\t\t\t\tthis.amapPlugin.getRegeo({\r\n\t\t\t\t\tsuccess: (data) => {\r\n\r\n\t\t\t\t\t\tself.currentlatitude = data[0].latitude\r\n\t\t\t\t\t\tself.currentlongitude = data[0].longitude\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (error) => {\r\n\t\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: self.systemRequest + \"/getBaseInfo\",\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tself.baseInfo = res.data\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: self.request + \"/getSlots\",\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tself.parkSlots = res.data\r\n\t\t\t\t\t\tfor (var i = 0; i < self.parkSlots.length; i++) {\r\n\t\t\t\t\t\t\tvar cover = [{\r\n\t\t\t\t\t\t\t\tlatitude: self.parkSlots[i].lat,\r\n\t\t\t\t\t\t\t\tlongitude: self.parkSlots[i].lng,\r\n\t\t\t\t\t\t\t\ticonPath: '../../static/location.png',\r\n\t\t\t\t\t\t\t\tid: i,\r\n\t\t\t\t\t\t\t\twidth: 40,      \r\n\t\t\t\t\t\t\t\theight: 40,\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t\tself.parkCovers.push(cover)\r\n\t\t\t\t\t\t\tself.parkDistance.push(self.getDistance(self.parkSlots[i].lat, self.parkSlots[i]\r\n\t\t\t\t\t\t\t\t.lng, self.currentlatitude, self.currentlongitude) * 1000)\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.getStorage({\r\n\t\t\t\t\tkey: \"user\",\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\turl: self.request + \"/getMyinfo\",\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tid: res.data.id\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\t\tsuccess: (response) => {\r\n\r\n\t\t\t\t\t\t\t\tself.user = response.data;\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\t\tconsole.log(\"网络异常\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t\r\n\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"sourceRoot":""}